# Tessera Environment Configuration

# --- Environment ---
# Options: development, staging, production
# production enables stricter security (e.g., restricted CORS methods)
ENVIRONMENT=development

# --- Database ---
# PostgreSQL (recommended for production): postgresql+asyncpg://user:pass@host:5432/db
# SQLite (dev/test only): sqlite+aiosqlite:///./tessera.db
DATABASE_URL=postgresql+asyncpg://tessera:tessera@localhost:5432/tessera

# --- API Server ---
API_HOST=0.0.0.0
API_PORT=8000
API_RELOAD=false

# --- Authentication ---
# Set to true ONLY for local development to bypass auth checks
AUTH_DISABLED=false
# Initial admin API key used to bootstrap the system (create first teams/keys)
BOOTSTRAP_API_KEY=

# --- CORS Settings ---
# Comma-separated list of allowed origins (e.g., http://localhost:3000)
# In production, wildcards (*) are NOT allowed.
CORS_ORIGINS=http://localhost:3000,http://localhost:5173
# Allowed methods in production (default: GET, POST, PATCH, DELETE, OPTIONS)
# CORS_ALLOW_METHODS=GET,POST,PATCH,DELETE,OPTIONS

# --- Redis Caching ---
# Required for performance and caching features
REDIS_URL=redis://localhost:6379/0
# Default TTL for cache entries in seconds
CACHE_TTL=300
# Domain-specific TTLs (overrides CACHE_TTL)
CACHE_TTL_CONTRACT=600
CACHE_TTL_ASSET=300
CACHE_TTL_TEAM=300
CACHE_TTL_SCHEMA=3600

# --- Rate Limiting ---
# Enable/disable global rate limiting middleware
RATE_LIMIT_ENABLED=true
# Formats: "100 per minute", "10/second", etc.
# Limits applied based on API key scope
RATE_LIMIT_READ=1000/minute
RATE_LIMIT_WRITE=100/minute
RATE_LIMIT_ADMIN=50/minute
# Fallback global limit for all requests
RATE_LIMIT_GLOBAL=5000/minute

# --- Resource Constraints ---
# Maximum size of a JSON Schema payload in bytes (default 1MB)
MAX_SCHEMA_SIZE_BYTES=1000000
# Maximum number of properties allowed in a single schema
MAX_SCHEMA_PROPERTIES=1000
# Maximum length of an Asset FQN string
MAX_FQN_LENGTH=1000
# Maximum length of a Team name string
MAX_TEAM_NAME_LENGTH=255
# Default environment stage for new assets (dev, staging, production)
DEFAULT_ENVIRONMENT=production

# --- Analysis Defaults ---
# Default depth for recursive impact analysis traversal
IMPACT_DEPTH_DEFAULT=5
# Maximum allowed depth for recursive impact analysis traversal
IMPACT_DEPTH_MAX=10

# --- Pagination ---
# Default number of items per page for list endpoints
PAGINATION_LIMIT_DEFAULT=50
# Maximum number of items allowed per page
PAGINATION_LIMIT_MAX=100

# --- Database Pool ---
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_TIMEOUT=30
DB_POOL_RECYCLE=3600

# --- Webhooks (Optional) ---
# WEBHOOK_URL=https://your-webhook-endpoint.com/webhooks
# WEBHOOK_SECRET=your-signing-secret

# --- Slack Notifications (Optional) ---
# Send notifications to Slack when proposals are created/acknowledged
# Get your webhook URL from: https://slack.com/apps/A0F7XDUAZ-incoming-webhooks
# SLACK_WEBHOOK_URL=https://hooks.slack.com/services/T.../B.../xxx

# --- Git Sync (Optional) ---
# Path to local directory for manifest synchronization
# GIT_SYNC_PATH=/path/to/repo
